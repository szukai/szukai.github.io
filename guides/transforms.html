<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Transforms and Filters | Kloudless Custom Connector</title>
    <meta name="description" content="Custom Connector Documentation">
    <link rel="icon" href="/kl-logo.png">
    <link rel="preload" href="/assets/css/0.styles.b4b7b21d.css" as="style"><link rel="preload" href="/assets/js/app.08ecdd18.js" as="script"><link rel="preload" href="/assets/js/2.7990bef6.js" as="script"><link rel="preload" href="/assets/js/8.4ed0f2ff.js" as="script"><link rel="prefetch" href="/assets/js/10.1669d027.js"><link rel="prefetch" href="/assets/js/11.0d59ae82.js"><link rel="prefetch" href="/assets/js/12.0ecea0e1.js"><link rel="prefetch" href="/assets/js/13.fc5ed85c.js"><link rel="prefetch" href="/assets/js/3.5436a352.js"><link rel="prefetch" href="/assets/js/4.08ff2735.js"><link rel="prefetch" href="/assets/js/5.dd41557f.js"><link rel="prefetch" href="/assets/js/6.43f9c60b.js"><link rel="prefetch" href="/assets/js/7.adeebfa7.js"><link rel="prefetch" href="/assets/js/9.95d3fa12.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b4b7b21d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Kloudless Custom Connector</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Intro</a></div><div class="nav-item"><a href="/guides/quickstart-storage.html" class="nav-link">Guides</a></div><div class="nav-item"><a href="/reference/kspec-ref.html" class="nav-link">Reference</a></div><div class="nav-item"><a href="https://kloudless.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Kloudless API
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Intro</a></div><div class="nav-item"><a href="/guides/quickstart-storage.html" class="nav-link">Guides</a></div><div class="nav-item"><a href="/reference/kspec-ref.html" class="nav-link">Reference</a></div><div class="nav-item"><a href="https://kloudless.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Kloudless API
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Guides</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/quickstart-storage.html" class="sidebar-link">Quickstart</a></li><li><a href="/guides/transforms.html" class="active sidebar-link">Transforms and Filters</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/transforms.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/guides/transforms.html#format" class="sidebar-link">Format</a></li><li class="sidebar-sub-header"><a href="/guides/transforms.html#transforms-an-example" class="sidebar-link">Transforms: An Example</a></li><li class="sidebar-sub-header"><a href="/guides/transforms.html#built-in-custom-filters" class="sidebar-link">Built-in Custom Filters</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/transforms.html#ref-transform" class="sidebar-link">ref_transform()</a></li><li class="sidebar-sub-header"><a href="/guides/transforms.html#timestring-to-unix" class="sidebar-link">timestring_to_unix()</a></li><li class="sidebar-sub-header"><a href="/guides/transforms.html#timestring-to-datetime" class="sidebar-link">timestring_to_datetime()</a></li><li class="sidebar-sub-header"><a href="/guides/transforms.html#expires-in-to-expiry" class="sidebar-link">expires_in_to_expiry()</a></li><li class="sidebar-sub-header"><a href="/guides/transforms.html#maybe-get" class="sidebar-link">maybe_get()</a></li></ul></li><li class="sidebar-sub-header"><a href="/guides/transforms.html#transforms-exceptions" class="sidebar-link">Transforms Exceptions</a></li></ul></li><li><a href="/guides/authentication.html" class="sidebar-link">Authentication Guide</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="transforms-and-filters"><a href="#transforms-and-filters" class="header-anchor">#</a> Transforms and Filters</h1> <p></p><div class="table-of-contents"><ul><li><a href="#overview">Overview</a></li><li><a href="#format">Format</a></li><li><a href="#transforms-an-example">Transforms: An Example</a></li><li><a href="#built-in-custom-filters">Built-in Custom Filters</a><ul><li><a href="#ref-transform">ref_transform()</a></li><li><a href="#timestring-to-unix">timestring_to_unix()</a></li><li><a href="#timestring-to-datetime">timestring_to_datetime()</a></li><li><a href="#expires-in-to-expiry">expires_in_to_expiry()</a></li><li><a href="#maybe-get">maybe_get()</a></li></ul></li><li><a href="#transforms-exceptions">Transforms Exceptions</a></li></ul></div><p></p> <h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <p>Kloudless transforms parse or translate object data formats between the service
endpoint API and the Kloudless platform. A transform definition is essentially
a YAML object with <a href="http://jinja.pocoo.org/docs" target="_blank" rel="noopener noreferrer">Jinja2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> variable rendering
utilizing the Jinja2 template engine.</p> <div class="custom-block danger"><p class="custom-block-title">Transformation exceptions</p> <p>There are a few differences between the Kloudless transforms and the
<a href="http://jinja.pocoo.org/docs" target="_blank" rel="noopener noreferrer">Jinja2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> template. Please refer to the
<a href="#transforms-exceptions">exceptions</a> below.</p></div> <h2 id="format"><a href="#format" class="header-anchor">#</a> Format</h2> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">transforms</span><span class="token punctuation">:</span>
    <span class="token key atrule">&lt;type_name&gt;</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
        &lt;multi-line template values&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Object data formats can be described by mapping types to their Jinja template
values. The template contents will be rendered into a YAML mapping that will be
then parsed internally.</p> <h2 id="transforms-an-example"><a href="#transforms-an-example" class="header-anchor">#</a> Transforms: An Example</h2> <p>Here's an excerpt from the KSpec file from our
<a href="../quickstart/storage">Storage Quickstart</a>.</p> <p>In this example we have the raw file data from Google Drive:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>raw_file_data <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">u'id'</span><span class="token punctuation">:</span> <span class="token string">u'1CRT3Yv6M2RAaph9OleCwNj*****'</span><span class="token punctuation">,</span>
  <span class="token string">u'kind'</span><span class="token punctuation">:</span> <span class="token string">u'drive#file'</span><span class="token punctuation">,</span>
  <span class="token string">u'mimeType'</span><span class="token punctuation">:</span> <span class="token string">u'application/vnd.google-apps.folder'</span><span class="token punctuation">,</span>
  <span class="token string">u'name'</span><span class="token punctuation">:</span> <span class="token string">u'test_create_folder'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Which needs its attributes converted to the Kloudless unified
<a href="https://developers.kloudless.com/docs/v1/storage#files" target="_blank" rel="noopener noreferrer">File<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> type format
below:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>transformed <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">u'id'</span><span class="token punctuation">:</span> <span class="token string">u'1CRT3Yv6M2RAaph9OleCwNj*****'</span><span class="token punctuation">,</span>
  <span class="token string">u'name'</span><span class="token punctuation">:</span> <span class="token string">u'test_create_folder'</span><span class="token punctuation">,</span>
  <span class="token string">u'mime_type'</span><span class="token punctuation">:</span> <span class="token string">u'application/vnd.google-apps.folder'</span><span class="token punctuation">,</span>
  <span class="token string">u'type'</span><span class="token punctuation">:</span> <span class="token string">u'folder'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>The transforms necessary to achieve this would be:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">transforms</span><span class="token punctuation">:</span>
    <span class="token key atrule">file</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
      id: {{data.id}}
      name: {{data.name}}
      mime_type: {{data.mimeType}}
      type: {{'folder' if data.mimeType.endswith('folder') else 'file'}}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Note the use of the <code>data</code> object from the raw file data. The <code>context</code> object
is also available for use as well.</p> <p>With the python script, the client can call on the <code>transform()</code> function to
transform the following</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>parsed <span class="token operator">=</span> client<span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>raw_file_data<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token punctuation">{</span><span class="token string">u'id'</span><span class="token punctuation">:</span> <span class="token string">u'1CRT3Yv6M2RAaph9OleCwNj*****'</span><span class="token punctuation">,</span>
 <span class="token string">u'name'</span><span class="token punctuation">:</span> <span class="token string">u'test_create_folder'</span><span class="token punctuation">,</span>
 <span class="token string">u'mime_type'</span><span class="token punctuation">:</span> <span class="token string">u'application/vnd.google-apps.folder'</span><span class="token punctuation">,</span>
 <span class="token string">u'type'</span><span class="token punctuation">:</span> <span class="token string">u'folder'</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="built-in-custom-filters"><a href="#built-in-custom-filters" class="header-anchor">#</a> Built-in Custom Filters</h2> <p>In addition to <a href="https://jinja.palletsprojects.com/en/2.10.x/templates/#list-of-builtin-filters" target="_blank" rel="noopener noreferrer">Jinja2's builtin template filters<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, the following filters are
also available for use with the Kloudless Custom Connector.</p> <h3 id="ref-transform"><a href="#ref-transform" class="header-anchor">#</a> ref_transform()</h3> <p>Renders a value by using the referenced transformation definition.</p> <p><code>ref_transform(context, value, transform_name)</code></p> <ul><li><code>context</code> - Template context</li> <li><code>value</code> - Value to transform</li> <li><code>transform_name</code> - Name of transformation reference.</li></ul> <p>Usage example:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">children</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
    data: {{ data.contents|ref_transform('file') }}</span>
<span class="token key atrule">file</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
    id: {{ data.Id }}
    name: {{ data.DisplayName }}
    mime_type: {{ data.Type }}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>In the above example, the <code>children</code> transforms would pass data['contents']
(a list) to the <code>file</code> transforms for parsing.</p> <p>A special feature about this filter is when given a single object, it will
produce the single parsed result; but if given a list, it will produce a list
of parsed results.</p> <p>It is possible to use <code>ref_transform()</code> to contain extra transformations to
avoid having multiple indentation levels.</p> <h3 id="timestring-to-unix"><a href="#timestring-to-unix" class="header-anchor">#</a> timestring_to_unix()</h3> <p>Converts a timestring to a
<a href="https://en.wikipedia.org/wiki/Unix_time" target="_blank" rel="noopener noreferrer">Unix timestamp<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> format.</p> <p><code>timestring_to_unix(value)</code></p> <ul><li><code>value</code> - Timestring value to convert.</li></ul> <p>Usage example:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">{</span><span class="token punctuation">{</span> '2019<span class="token punctuation">-</span>09<span class="token punctuation">-</span>01T11<span class="token punctuation">:</span>00Z'<span class="token punctuation">|</span>timestring_to_unix <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This filter will convert <code>2019-09-01T11:00Z</code> to <code>1567335600.0</code>.</p> <p>Some services' API will return time information i.e. <code>created</code> or <code>last_updated</code>
with a ISO-8601 timestring. The Kloudless platform however, accepts time
information in Unix timestamp format. This filter can assist in converting the
time information if needed.</p> <h3 id="timestring-to-datetime"><a href="#timestring-to-datetime" class="header-anchor">#</a> timestring_to_datetime()</h3> <p>Converts a timestring to a datetime format.</p> <p><code>timestring_to_datetime(value)</code></p> <ul><li><code>value</code> - Timestring value to convert.</li></ul> <p>Usage example:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">{</span><span class="token punctuation">{</span> '2019<span class="token punctuation">-</span>09<span class="token punctuation">-</span>01T11<span class="token punctuation">:</span>00Z'<span class="token punctuation">|</span>timestring_to_datetime <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This filter will convert <code>2019-09-01T11:00Z</code> to a datetime object
<code>datetime(2019, 9, 1, 11, 0)</code>.</p> <p>While the Kloudless platform generally accepts the Unix timestamp format. There
are a few properties that use <code>datetime</code> instead. e.x. <code>event_time</code> for events
objects, or <code>expiry</code> in the notification_settings object.</p> <h3 id="expires-in-to-expiry"><a href="#expires-in-to-expiry" class="header-anchor">#</a> expires_in_to_expiry()</h3> <p>Adds the input seconds value with current Unix timestamp. This function can be
useful for converting &quot;expires_in&quot; value in access token response to the
absolute expiration timestamp (&quot;expires_at&quot;).</p> <p><code>expires_in_to_expiry(value)</code></p> <ul><li><code>value</code> - Unix timestamp value to convert.</li></ul> <p>Usage example:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">{</span><span class="token punctuation">{</span> 3600<span class="token punctuation">|</span>expires_in_to_expiry <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>In the example above, if the current timestamp is <code>1568171093.542906</code>, then
the filter will return the timestamp value of <code>1568174693.542906</code>.</p> <p>This filter will most likely be useful in access token parsing. Some access
token responses provide expire time in <code>expires_in</code>, while some others provide
the information as <code>expires_at</code>.</p> <h3 id="maybe-get"><a href="#maybe-get" class="header-anchor">#</a> maybe_get()</h3> <p>Similar to Python dictionary's <code>get()</code>, <code>maybe_get()</code> will retrieve a value from
a dictionary key, but will get the multi-level nested value in the
dictionary object, or return a default value if the key/value is otherwise
absent.</p> <p><code>maybe_get(value, *path, **kwargs)</code></p> <ul><li><code>value</code> - Value to retrieve</li> <li><code>path</code>, <code>kwargs</code> - Dictionary key values to get. i.e. 'result', 'object'</li></ul> <p>Usage example:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">{</span><span class="token punctuation">{</span> data<span class="token punctuation">|</span>maybe_get('prop1'<span class="token punctuation">,</span> <span class="token string">'inner_key'</span><span class="token punctuation">,</span> default='default value') <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Given the following dictionary:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>data <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">'prop1'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'inner_key'</span><span class="token punctuation">:</span> <span class="token string">'target value'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>The result in the example will yield <code>target value</code>. If the definition of the
<code>data</code> dictionary is changed and any of the keys are different or not found, then
<code>default value</code> would be returned instead.</p> <h2 id="transforms-exceptions"><a href="#transforms-exceptions" class="header-anchor">#</a> Transforms Exceptions</h2> <p>There are a few differences between the Kloudless transforms and the
<a href="http://jinja.pocoo.org/docs" target="_blank" rel="noopener noreferrer">Jinja2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> template behavior. Certain patterns will
not work.</p> <div class="custom-block danger"><p class="custom-block-title">Don't:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>  <span class="token key atrule">account_info</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
    account: {{data.user_id}}@{{data.domain}}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>This in some situations may cause result like below and then YAML parsing error.
account: ‘123456’@’something.com'</p></div> <div class="custom-block tip"><p class="custom-block-title">Do:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>  <span class="token key atrule">account_info</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
    account: {{'%s@%s' % (data.user_id, data.domain)}}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>KSpec transforms will facilitate the necessary YAML escapes when rendering.
E.g.</p> <ul><li>'abc' -&gt; abc;</li> <li>&quot;I'm a sentence.&quot; -&gt; &quot;I'm a sentence&quot;;</li> <li>&quot;frank's friend said: &quot;okay...&quot;.&quot; -&gt; 'frank''s friend said: &quot;okay...&quot;.' .</li></ul></div> <div class="custom-block danger"><p class="custom-block-title">Don't:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>  <span class="token key atrule">folder</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
    name: '{{data.Name}}'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>KSpec transforms' internal mechanism will handle string quotations
if needed. Extra/Manual quotes may break the transformation.</p></div> <div class="custom-block tip"><p class="custom-block-title">Do:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>  <span class="token key atrule">folder</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
    name: {{data.Name}}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Kspec transforms will handle numeric strings as well.
E.g.</p> <ul><li>{“Name”: “123”} -&gt; name: ‘123’</li> <li>{“Name”: 123} -&gt; name: 123</li></ul></div> <div class="custom-block danger"><p class="custom-block-title">Don't:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>  <span class="token key atrule">event</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
    metadata: {{data|ref_transform(‘event_meta’)}}
        extra_prop: {{data.something}}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>extra_prop</code> above will cause an YAML parsing error. Try to avoid having
multiple levels of indentation as the KSpec transforms' internal mechanism
renders in flow style formatting, which will conflict with the block style
formatting shown above.</p></div> <div class="custom-block tip"><p class="custom-block-title">Do:</p> <p>In the event that additional variables are required (above), utilize
the following method instead:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>  <span class="token key atrule">event</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
    {% set parsed = data|ref_transform(‘event_meta’) %}
    {% set tmp = parsed.__setitem__(‘extra_prop’, data.something) %}
    metadata: {{parsed}}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div> <div class="custom-block tip"><p class="custom-block-title">Do:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>  <span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token punctuation">[</span>data<span class="token punctuation">|</span>ref_transform(‘ev_meta’)<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>To render the result as an YAML list with a single item.</p></div> <div class="custom-block tip"><p class="custom-block-title">Do:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>  <span class="token punctuation">{</span><span class="token punctuation">{</span> %s % data.value <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>or</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">{</span><span class="token punctuation">{</span> data.value<span class="token punctuation">|</span>string <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>To enforce a string type result.</p></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guides/quickstart-storage.html" class="prev">Quickstart</a></span> <span class="next"><a href="/guides/authentication.html">Authentication Guide</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.08ecdd18.js" defer></script><script src="/assets/js/2.7990bef6.js" defer></script><script src="/assets/js/8.4ed0f2ff.js" defer></script>
  </body>
</html>
