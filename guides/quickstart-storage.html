<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Quickstart: Storage Custom Connector (Google Drive) | Kloudless Custom Connector</title>
    <meta name="description" content="Custom Connector Documentation">
    <link rel="icon" href="/kl-logo.png">
    <link rel="preload" href="/assets/css/0.styles.b4b7b21d.css" as="style"><link rel="preload" href="/assets/js/app.08ecdd18.js" as="script"><link rel="preload" href="/assets/js/2.7990bef6.js" as="script"><link rel="preload" href="/assets/js/7.adeebfa7.js" as="script"><link rel="prefetch" href="/assets/js/10.1669d027.js"><link rel="prefetch" href="/assets/js/11.0d59ae82.js"><link rel="prefetch" href="/assets/js/12.0ecea0e1.js"><link rel="prefetch" href="/assets/js/13.fc5ed85c.js"><link rel="prefetch" href="/assets/js/3.5436a352.js"><link rel="prefetch" href="/assets/js/4.08ff2735.js"><link rel="prefetch" href="/assets/js/5.dd41557f.js"><link rel="prefetch" href="/assets/js/6.43f9c60b.js"><link rel="prefetch" href="/assets/js/8.4ed0f2ff.js"><link rel="prefetch" href="/assets/js/9.95d3fa12.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b4b7b21d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Kloudless Custom Connector</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Intro</a></div><div class="nav-item"><a href="/guides/quickstart-storage.html" class="nav-link router-link-exact-active router-link-active">Guides</a></div><div class="nav-item"><a href="/reference/kspec-ref.html" class="nav-link">Reference</a></div><div class="nav-item"><a href="https://kloudless.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Kloudless API
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Intro</a></div><div class="nav-item"><a href="/guides/quickstart-storage.html" class="nav-link router-link-exact-active router-link-active">Guides</a></div><div class="nav-item"><a href="/reference/kspec-ref.html" class="nav-link">Reference</a></div><div class="nav-item"><a href="https://kloudless.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Kloudless API
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Guides</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/quickstart-storage.html" class="active sidebar-link">Quickstart</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/quickstart-storage.html#introduction" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/quickstart-storage.html#quickstart-samples" class="sidebar-link">Quickstart Samples</a></li></ul></li><li class="sidebar-sub-header"><a href="/guides/quickstart-storage.html#openapi-document" class="sidebar-link">OpenAPI Document</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/quickstart-storage.html#swagger-version-metadata-host-and-basepath-information" class="sidebar-link">Swagger Version, Metadata, Host, and Basepath Information</a></li><li class="sidebar-sub-header"><a href="/guides/quickstart-storage.html#security-definitions" class="sidebar-link">Security Definitions</a></li><li class="sidebar-sub-header"><a href="/guides/quickstart-storage.html#paths" class="sidebar-link">Paths</a></li></ul></li><li class="sidebar-sub-header"><a href="/guides/quickstart-storage.html#kloudless-specification-file" class="sidebar-link">Kloudless Specification File</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/quickstart-storage.html#kloudless-version-openapi-and-script-location" class="sidebar-link">Kloudless Version, OpenAPI and Script Location</a></li><li class="sidebar-sub-header"><a href="/guides/quickstart-storage.html#service-info-and-authentication" class="sidebar-link">Service Info and Authentication</a></li><li class="sidebar-sub-header"><a href="/guides/quickstart-storage.html#features" class="sidebar-link">Features</a></li><li class="sidebar-sub-header"><a href="/guides/quickstart-storage.html#transforms" class="sidebar-link">Transforms</a></li></ul></li><li class="sidebar-sub-header"><a href="/guides/quickstart-storage.html#python-sdk-script" class="sidebar-link">Python SDK Script</a></li><li class="sidebar-sub-header"><a href="/guides/quickstart-storage.html#testing-usage" class="sidebar-link">Testing/Usage</a></li></ul></li><li><a href="/guides/transforms.html" class="sidebar-link">Transforms and Filters</a></li><li><a href="/guides/authentication.html" class="sidebar-link">Authentication Guide</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="quickstart-storage-custom-connector-google-drive"><a href="#quickstart-storage-custom-connector-google-drive" class="header-anchor">#</a> Quickstart: Storage Custom Connector (Google Drive)</h1> <p></p><div class="table-of-contents"><ul><li><a href="#introduction">Introduction</a><ul><li><a href="#quickstart-samples">Quickstart Samples</a></li></ul></li><li><a href="#openapi-document">OpenAPI Document</a><ul><li><a href="#swagger-version-metadata-host-and-basepath-information">Swagger Version, Metadata, Host, and Basepath Information</a></li><li><a href="#security-definitions">Security Definitions</a></li><li><a href="#paths">Paths</a></li></ul></li><li><a href="#kloudless-specification-file">Kloudless Specification File</a><ul><li><a href="#kloudless-version-openapi-and-script-location">Kloudless Version, OpenAPI and Script Location</a></li><li><a href="#service-info-and-authentication">Service Info and Authentication</a></li><li><a href="#features">Features</a></li><li><a href="#transforms">Transforms</a></li></ul></li><li><a href="#python-sdk-script">Python SDK Script</a></li><li><a href="#testing-usage">Testing/Usage</a></li></ul></div><p></p> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>This guide will demonstrate parts of a demo Google Drive custom connector using
Google Drive v3 REST API.</p> <p>As mentioned in the Custom Connector <a href="/#introduction">Introduction</a> the
Kloudless Custom Connector is composed of three separate parts.</p> <ul><li>An <a href="#openapi-document">OpenAPI document</a> of the upstream service API you want
to use.</li> <li>A <a href="#kloudless-specification-file">Kloudless specification file</a> describing the
behavior, properties and format mappings/transformations of the service.</li> <li>A <a href="#python-sdk-script">Python SDK script</a> with routing and endpoint
pre/post-processing logic.</li></ul> <p>The sample custom connector in this guide will allow the user to connect to
Google Drive with file CRUD endpoints and/or operations.</p> <h3 id="quickstart-samples"><a href="#quickstart-samples" class="header-anchor">#</a> Quickstart Samples</h3> <p>Sample files for this quickstart can be found below:</p> <ul><li>OpenAPI: <a href="/code/gdrive-sample-oapi.yml">gdrive-sample-oapi.yml</a></li> <li>KSpec: <a href="/code/gdrive-sample-kspec.yml">gdrive-sample-kspec.yml</a></li> <li>Python Script: <a href="/code/gdrive-sample.py">gdrive-sample.py</a></li></ul> <h2 id="openapi-document"><a href="#openapi-document" class="header-anchor">#</a> OpenAPI Document</h2> <p>The OpenAPI document describes the connected service's REST API specification.
Head over to the <a href="../reference/oapi-ref">OpenAPI specification</a> page or
directly to the <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md" target="_blank" rel="noopener noreferrer">OpenAPI v2 specification<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
to learn more.</p> <p>While the Kloudless custom connector utilizes the OpenAPI specification to
define how the connected service's endpoints, only certain fields are required.
The intent of this guide is to only cover the basics necessary for a working
custom connector. A complete OpenAPI specification is ideal, but may not be
used by the Kloudless platform.</p> <p>The full version of the
<a href="/code/gdrive-sample-oapi.yml">sample OpenAPI document</a> is available
and can also be found on the project <a href="https://github.com/Kloudless" target="_blank" rel="noopener noreferrer">Github page<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="swagger-version-metadata-host-and-basepath-information"><a href="#swagger-version-metadata-host-and-basepath-information" class="header-anchor">#</a> Swagger Version, Metadata, Host, and Basepath Information</h3> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">swagger</span><span class="token punctuation">:</span> <span class="token string">&quot;2.0&quot;</span>
<span class="token key atrule">info</span><span class="token punctuation">:</span>
    <span class="token key atrule">title</span><span class="token punctuation">:</span> Google Drive Quickstart Example
    <span class="token key atrule">description</span><span class="token punctuation">:</span> Sample specification for Kloudless Custom Connector
    <span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;1.0.0&quot;</span>
<span class="token key atrule">schemes</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> https
<span class="token key atrule">host</span><span class="token punctuation">:</span> www.googleapis.com
<span class="token key atrule">basePath</span><span class="token punctuation">:</span> /drive/v3
<span class="token key atrule">produces</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> application/json
<span class="token key atrule">consumes</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> application/json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>Like every other OpenAPI specification, you'll want the OpenAPI version, as well
as relevant metadata (for good documentation). The <code>host</code>, <code>basePath</code>, <code>schemes</code>
and <code>produces</code>/<code>consumes</code> is also fundamental.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Currently only the OpenAPI v2 specification is supported.</p></div> <h3 id="security-definitions"><a href="#security-definitions" class="header-anchor">#</a> Security Definitions</h3> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">securityDefinitions</span><span class="token punctuation">:</span>
    <span class="token key atrule">oauth2</span><span class="token punctuation">:</span>
        <span class="token key atrule">type</span><span class="token punctuation">:</span> oauth2
        <span class="token key atrule">scopes</span><span class="token punctuation">:</span>
            <span class="token key atrule">&quot;https://www.googleapis.com/auth/userinfo.email&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Read user email&quot;</span>
            <span class="token key atrule">&quot;https://www.googleapis.com/auth/userinfo.profile&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Read user public profile&quot;</span>
            <span class="token key atrule">&quot;https://www.googleapis.com/auth/drive&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Write files&quot;</span>
            <span class="token key atrule">&quot;https://www.googleapis.com/auth/drive.file&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Manage files&quot;</span>
            <span class="token key atrule">&quot;https://www.googleapis.com/auth/drive.metadata&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Manage metadata of files&quot;</span>
        <span class="token key atrule">flow</span><span class="token punctuation">:</span> accessCode
        <span class="token key atrule">authorizationUrl</span><span class="token punctuation">:</span> <span class="token string">&quot;https://accounts.google.com/o/oauth2/v2/auth&quot;</span>
        <span class="token key atrule">tokenUrl</span><span class="token punctuation">:</span> <span class="token string">&quot;https://www.googleapis.com/oauth2/v4/token&quot;</span>
        <span class="token key atrule">x-request-token-params</span><span class="token punctuation">:</span>
            <span class="token key atrule">access_type</span><span class="token punctuation">:</span> offline
            <span class="token key atrule">prompt</span><span class="token punctuation">:</span> consent
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>Only <strong>one</strong> <code>securityDefinitions</code> will be parsed and used.</p> <p>The scopes listed inside will be the ones asked for in authentication page,
comment off or remove the scopes that are not used.</p> <p>The custom <code>x-request-token-params</code> is used to specify extra query parameters
during the OAuth user authentication step. <code>x-access-token-params</code> can be
used for the access token request.</p> <h3 id="paths"><a href="#paths" class="header-anchor">#</a> Paths</h3> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">paths</span><span class="token punctuation">:</span>
    <span class="token key atrule">/about</span><span class="token punctuation">:</span>
        <span class="token key atrule">get</span><span class="token punctuation">:</span>
            <span class="token key atrule">operationId</span><span class="token punctuation">:</span> get_self
            <span class="token key atrule">produces</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> application/json
            <span class="token key atrule">security</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">oauth2</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token key atrule">parameters</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> fields
              <span class="token key atrule">in</span><span class="token punctuation">:</span> query
              <span class="token key atrule">type</span><span class="token punctuation">:</span> string
              <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
            <span class="token key atrule">responses</span><span class="token punctuation">:</span>
                <span class="token key atrule">&quot;200&quot;</span><span class="token punctuation">:</span>
                    <span class="token key atrule">description</span><span class="token punctuation">:</span> ok
    <span class="token key atrule">/files</span><span class="token punctuation">:</span>
        <span class="token key atrule">get</span><span class="token punctuation">:</span>
            <span class="token key atrule">operationId</span><span class="token punctuation">:</span> search_files
            <span class="token key atrule">produces</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> application/json
            <span class="token key atrule">security</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">oauth2</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token key atrule">parameters</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> orderBy
              <span class="token key atrule">in</span><span class="token punctuation">:</span> query
              <span class="token key atrule">type</span><span class="token punctuation">:</span> string
              <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> pageSize
              <span class="token key atrule">in</span><span class="token punctuation">:</span> query
              <span class="token key atrule">type</span><span class="token punctuation">:</span> integer
              <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> pageToken
              <span class="token key atrule">in</span><span class="token punctuation">:</span> query
              <span class="token key atrule">type</span><span class="token punctuation">:</span> string
              <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> q
              <span class="token key atrule">in</span><span class="token punctuation">:</span> query
              <span class="token key atrule">type</span><span class="token punctuation">:</span> string
              <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> fields
              <span class="token key atrule">in</span><span class="token punctuation">:</span> query
              <span class="token key atrule">type</span><span class="token punctuation">:</span> string
              <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
            <span class="token key atrule">responses</span><span class="token punctuation">:</span>
                <span class="token key atrule">&quot;200&quot;</span><span class="token punctuation">:</span>
                    <span class="token key atrule">description</span><span class="token punctuation">:</span> ok
        <span class="token key atrule">post</span><span class="token punctuation">:</span>
            <span class="token key atrule">operationId</span><span class="token punctuation">:</span> create_file
            <span class="token key atrule">produces</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> application/json
            <span class="token key atrule">security</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">oauth2</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token key atrule">parameters</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> uploadType
              <span class="token key atrule">in</span><span class="token punctuation">:</span> query
              <span class="token key atrule">type</span><span class="token punctuation">:</span> string
              <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> body
              <span class="token key atrule">in</span><span class="token punctuation">:</span> body
              <span class="token key atrule">type</span><span class="token punctuation">:</span> object
              <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
              <span class="token key atrule">schema</span><span class="token punctuation">:</span>
                  <span class="token key atrule">properties</span><span class="token punctuation">:</span>
                      <span class="token key atrule">name</span><span class="token punctuation">:</span>
                          <span class="token key atrule">type</span><span class="token punctuation">:</span> string
                      <span class="token key atrule">parents</span><span class="token punctuation">:</span>
                          <span class="token key atrule">type</span><span class="token punctuation">:</span> array
                          <span class="token key atrule">items</span><span class="token punctuation">:</span>
                              <span class="token key atrule">type</span><span class="token punctuation">:</span> string
                      <span class="token key atrule">mimeType</span><span class="token punctuation">:</span>
                          <span class="token key atrule">type</span><span class="token punctuation">:</span> string
            <span class="token key atrule">responses</span><span class="token punctuation">:</span>
                <span class="token key atrule">&quot;200&quot;</span><span class="token punctuation">:</span>
                    <span class="token key atrule">description</span><span class="token punctuation">:</span> ok
    <span class="token punctuation">...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br></div></div><p>Paths describes the url endpoints for the connected service.</p> <p>In the <code>paths</code> section, there is no need to specify a full schema for
<code>responses</code>, a minimum with <code>&quot;200&quot;</code> with <code>&quot;description: ok&quot;</code> may be enough.</p> <p>The <code>parameters</code> objects can be referenced, but the <code>name</code> property is always
required.</p> <h2 id="kloudless-specification-file"><a href="#kloudless-specification-file" class="header-anchor">#</a> Kloudless Specification File</h2> <p>The Kloudless Specification (KSpec) file contains information describing the
behavior, properties and format mappings/transformations of the connected
service. The Kloudless platform will also look for where the OpenAPI and
python script files are from the KSpec file.</p> <p>The full version of the
<a href="/code/gdrive-sample-kspec.yml">sample KSpec file</a> is available as well.</p> <p>For details on each parameter, please refer to the
<a href="../reference/kspec-ref">Kloudless Specification Reference</a></p> <h3 id="kloudless-version-openapi-and-script-location"><a href="#kloudless-version-openapi-and-script-location" class="header-anchor">#</a> Kloudless Version, OpenAPI and Script Location</h3> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">kloudless</span><span class="token punctuation">:</span> connector
<span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;0.2&quot;</span>
<span class="token key atrule">openapi</span><span class="token punctuation">:</span> <span class="token string">&quot;gdrive-sample-oapi.yml&quot;</span>
<span class="token key atrule">script</span><span class="token punctuation">:</span> <span class="token string">&quot;gdrive-sample.py&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Currently the Kloudless Specification only supports the <code>connector</code> value, with
version <code>&quot;0.2&quot;</code>.</p> <p>Specify the <code>openapi</code> and <code>script</code> parameters with the filenames for the OpenAPI
YAML document and <a href="#python-sdk-script">python SDK script</a> files respectively.</p> <h3 id="service-info-and-authentication"><a href="#service-info-and-authentication" class="header-anchor">#</a> Service Info and Authentication</h3> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">service_info</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> gdrive_quickstart
    <span class="token key atrule">friendly_name</span><span class="token punctuation">:</span> Google Drive Quickstart Example
    <span class="token key atrule">auth</span><span class="token punctuation">:</span> oauth2
    <span class="token key atrule">apis</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> storage
    <span class="token key atrule">category</span><span class="token punctuation">:</span> storage
    <span class="token key atrule">initially_visible</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
<span class="token key atrule">authentication</span><span class="token punctuation">:</span>
    <span class="token key atrule">handle_response</span><span class="token punctuation">:</span> access_token
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>The <code>service_info</code> mapping contains information for the connected service.
It will be used to create new service record in the Kloudless' Services
database.</p> <p>The name used for the <code>name</code> parameter is used internally with the Kloudless
platform, and thus cannot be a duplicate with any
<a href="https://developers.kloudless.com/docs/latest/core#introduction-supported-services" target="_blank" rel="noopener noreferrer">existing Kloudless service<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. <code>friendly_name</code> is what will be shown in
the authentication user interface when the service gets connected.</p> <p>The Google Drive sample service will also authenticate using OAuth2. The
Kloudless platform supports <code>basic</code> authentication as well. More details on
authentication can be found in the <a href="authentication">Authentication guide</a>.</p> <p>The <code>authentication</code> mapping works in tandem with <code>securityDefinitions</code> parameter
inside the OpenAPI definition file. The <code>access_token</code> value is the name of the
<a href="#transforms">transformation</a> that will handle the authentication object data.</p> <p>As Google Drive is an online storage service, the <code>category</code> should be set to
<code>storage</code>. Although its API feature set can also cover <code>teams</code> and <code>events</code>, for
demonstration purposes only the <code>storage</code> feature-set will be covered, so there
will only be one entry under the <code>apis</code> parameter.</p> <p><code>initially_visible</code> is set to <code>false</code> as the custom connector will be made visible
for public use later after testing if desired.</p> <h3 id="features"><a href="#features" class="header-anchor">#</a> Features</h3> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">features</span><span class="token punctuation">:</span>
    <span class="token key atrule">defaults</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> base<span class="token punctuation">-</span><span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>The <code>features</code> mapping contains a list of
<a href="../reference/properties-ref">properties</a> for the connected service. Properties
define what features and behaviors a service is capable of. The
Kloudless platform has support for a couple of default base values with the
<code>defaults</code> mapping with <code>base-1</code> as a value which includes basic authentication
default settings.</p> <h3 id="transforms"><a href="#transforms" class="header-anchor">#</a> Transforms</h3> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">transforms</span><span class="token punctuation">:</span>
    <span class="token key atrule">access_token</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
        access_token: {{data.access_token}}
        expiry: {{data.expires_in|expires_in_to_expiry}}
        refresh_token: {{data.refresh_token}}</span>
    <span class="token key atrule">get_self_params</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
        fields: user</span>
    <span class="token key atrule">account_info</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
        account_name: {{data.user.emailAddress}}
        account_id: {{data.user.emailAddress}}</span>
    <span class="token key atrule">file</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
        id: {{data.id}}
        name: {{data.name}}
        mime_type: {{data.mimeType}}
        type: {{'folder' if data.mimeType.endswith('folder') else 'file'}}
        {% if context.parent %}
        parent:
            id: {{context.parent.id}}
            name: {{context.parent.name}}
        {% endif %}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>The Kloudless specification file utilizes transforms to parse or translate
object data formats between the service endpoint API and the Kloudless
platform. A transform definition is essentially a YAML object with
<a href="http://jinja.pocoo.org/docs" target="_blank" rel="noopener noreferrer">Jinja2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> variable rendering utilizing the
Jinja2 template engine.</p> <p>More details can be found in the <a href="transforms">Transformations Guide</a>.</p> <p><code>get_self_params</code> transforms the parameters for the <code>get_self</code> operation under
the <code>/about</code> endpoint by loading the <code>user</code> data to <code>fields</code>.</p> <p>The <code>file</code> transformation gets called on later in the via the <code>client.transforms()</code> <a href="#python-sdk-script">python script</a>.</p> <h2 id="python-sdk-script"><a href="#python-sdk-script" class="header-anchor">#</a> Python SDK Script</h2> <p>With the basic URL endpoints and connector properties defined, the last thing
needed is to implement the remaining pre/post-processing logic with connector
methods in the python script defined earlier in the
<a href="#kloudless-version-openpi-and-script-location">Kspec file</a>.</p> <p>Each endpoint implemented should have a corresponding
<a href="../reference/properties-ref">property</a> name. The custom connector will then
register the method with the corresponding unified endpoint on the Kloudless
platform.</p> <p>A complete copy of the sample script file can be found
<a href="/code/gdrive-sample.py">here</a>.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> kloudless_connector <span class="token keyword">import</span> Connector
<span class="token keyword">from</span> kloudless_connector<span class="token punctuation">.</span>exceptions <span class="token keyword">import</span> BadRequest
<span class="token keyword">import</span> mimetypes
connector <span class="token operator">=</span> Connector<span class="token punctuation">(</span><span class="token punctuation">)</span>
@connector<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">&quot;storage.folders.list&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">folder_contents</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span> request_data<span class="token punctuation">,</span> prop<span class="token punctuation">)</span><span class="token punctuation">:</span>
    parent_id <span class="token operator">=</span> request_data<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span>
    recursive <span class="token operator">=</span> request_data<span class="token punctuation">[</span><span class="token string">'recursive'</span><span class="token punctuation">]</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    next_page <span class="token operator">=</span> response_dict<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'nextPageToken'</span><span class="token punctuation">)</span>
    children <span class="token operator">=</span> client<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>
        <span class="token string">'file'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>response_dict<span class="token punctuation">[</span><span class="token string">'files'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> interface_context<span class="token operator">=</span>extra_context
    <span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token string">'success'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
        <span class="token string">'data'</span><span class="token punctuation">:</span> children <span class="token keyword">or</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'next_page'</span><span class="token punctuation">:</span> next_page<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>The <code>folder_contents</code> function contains the code for processing a request to
list a folder's contents. It is registered to the <code>storage.folders.list</code>
property, which corresponds to the <code>GET /accounts/{account_id}/storage/folders/{folder_id}/contents</code>
endpoint on the Kloudless platform.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token decorator annotation punctuation">@connector<span class="token punctuation">.</span>register</span><span class="token punctuation">(</span><span class="token string">&quot;storage.*.read&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_meta</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span> request_data<span class="token punctuation">,</span> prop<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>The Kloudless custom connector supports a wild-card filter to handle properties
for connector functions as well. The <code>get_meta()</code> function above will be
registered to both <code>storage.file.read</code> and <code>storage.folder.read</code> so it will
be called when reading both files and folders.</p> <h2 id="testing-usage"><a href="#testing-usage" class="header-anchor">#</a> Testing/Usage</h2> <p>Use the git sync feature in the
<a href="https://developers.kloudless.com/" target="_blank" rel="noopener noreferrer">Kloudless Developers Portal<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to load them
to the Kloudless platform. However, the service will not be initially visible.
Kloudless will also have console <code>ke-commands</code> in the future to assist with
custom connector deployment and configuration as well.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/guides/transforms.html">Transforms and Filters</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.08ecdd18.js" defer></script><script src="/assets/js/2.7990bef6.js" defer></script><script src="/assets/js/7.adeebfa7.js" defer></script>
  </body>
</html>
